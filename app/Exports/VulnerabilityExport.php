<?php

namespace App\Exports;

use Maatwebsite\Excel\Concerns\FromCollection;
use Maatwebsite\Excel\Concerns\WithHeadings;

class VulnerabilityExport implements FromCollection , WithHeadings
{
    /**
    * @return \Illuminate\Support\Collection
    */


    protected $vulnerabilities;

    public function __construct($vulnerabilities)
    {
        $this->vulnerabilities = $vulnerabilities;
    }

    public function collection()
    {
        return collect($this->vulnerabilities);
    }


    public function headings(): array
    {
        // Define the headings for your Excel file
        return [
            'Name',
            'Description',
            'Risk',
            "Social Score",
            'Severity',
            'First Seen',
            'Last Identified On',
            'Patch Priority',
            "Impact",
            "Solution",
            "Workaround",
            "Result",
            'Patches Count',
            'Exploits Count',
            'Assets',
            'CVEs',
            'Assets Count'
        ];


     
    }
}
